import{r as x,G as B,j as e}from"./index-DmoKgCWG.js";import{z as l,u as I,t as E,F as P,h as n,i,j as c,k as o,I as M,l as d,B as b,e as k}from"./form-DzQ4cgiB.js";import{D as q,a as T,b as V,c as L,P as _,d as A,f as S,C as G,e as H,g as U,h as $,S as z,i as J,j as R,k as W,l as j,m as Y,s as K,n as Q,t as N}from"./Dashboard-6TzHkf6M.js";const X=[{id:"mathematics",label:"Mathematics"},{id:"science",label:"Science"},{id:"french",label:"French"},{id:"physics",label:"Physics"},{id:"chemistry",label:"Chemistry"}],Z=l.object({fullName:l.string({required_error:"Full Name is required"}).min({message:"Must be 5 or more characters long"}),dateOfBirth:l.date({required_error:"Date of Birth is required"}),subjects:l.array(l.string()).refine(h=>h.some(u=>u),{message:"You have to select at least one item."}),subscriptionStatus:l.string({required_error:"Invalid Subscription Status ."})}),te=({setStudents:h,setOpen:u,student:r})=>{const[v,p]=x.useState(!1),{setIsLoading:m,setIsError:C,setError:y,setIsSuccess:F}=x.useContext(B),t=I({resolver:E(Z),defaultValues:r});x.useEffect(()=>{t.reset({...r,dateOfBirth:new Date(r.dateOfBirth)})},[r]);function D(s){m(!0),s.dateOfBirth=S(s.dateOfBirth,"yyyy-MM-dd"),console.log("submited values",s),fetch(`http://localhost:2000/api/students/${r.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(a=>a.json()).then(a=>{h(a),K.dispatch(Q([...a])),t.reset({fullName:"",dateOfBirth:"",subjects:[],subscriptionStatus:"",id:""}),u(!1),m(!1),F(!0),N({title:"success",description:"Student Info Updated seccusfully"})}).catch(a=>{C(!0),y(a.message),m(!1),N({title:"error",description:a.message})})}return e.jsxs(q,{className:"sm:max-w-[425px]",children:[e.jsxs(T,{children:[e.jsx(V,{children:"Edit Student"}),e.jsx(L,{children:"Enter the student information below."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsx(P,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(D),className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-4 items-center gap-4 ",children:e.jsx(n,{control:t.control,name:"fullName",render:({field:s})=>e.jsxs(i,{className:"col-span-4",children:[e.jsx(c,{className:"text-right",children:"Full Name"}),e.jsx(o,{children:e.jsx(M,{placeholder:r.fullName,value:s.value,...s})}),e.jsx(d,{})]})})}),e.jsx("div",{className:"grid grid-cols-4 items-center gap-4",children:e.jsx(n,{control:t.control,name:"dateOfBirth",render:({field:s})=>e.jsxs(i,{className:"col-span-4",children:[e.jsx(c,{children:"Date of birth"}),e.jsxs(_,{open:v,onOpenChange:p,children:[e.jsx(A,{asChild:!0,children:e.jsx(o,{children:e.jsxs(b,{variant:"outline",className:k("w-full pl-3 text-left font-normal",!s.value&&"text-muted-foreground"),children:[s.value?S(s.value,"MM/dd/yyyy"):e.jsx("span",{children:"Pick A Date"}),e.jsx(G,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(H,{className:"w-auto p-0",align:"start",children:e.jsx(U,{mode:"single",selected:s.value,onSelect:a=>{s.onChange(a),p(!1)},disabled:a=>a>new Date||a<new Date("1900-01-01"),initialFocus:!0})})]}),e.jsx(d,{})]})})}),e.jsx("div",{className:"grid grid-cols-4 items-center gap-4",children:e.jsx(n,{control:t.control,name:"subjects",render:()=>e.jsxs(i,{className:"col-span-4",children:[e.jsx(c,{children:"Subjects"}),X.map(s=>e.jsx(n,{control:t.control,name:"subjects",render:({field:a})=>{var g;return e.jsxs(i,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(o,{children:e.jsx($,{checked:(g=a.value)==null?void 0:g.includes(s.id),onCheckedChange:O=>{var f;return O?a.onChange([...a.value,s.id]):a.onChange((f=a.value)==null?void 0:f.filter(w=>w!==s.id))}})}),e.jsx(c,{className:"font-normal",children:s.label})]},s.id)}},s.id)),e.jsx(d,{})]})})}),e.jsx("div",{className:"grid grid-cols-4 items-center gap-4",children:e.jsx(n,{control:t.control,name:"subscriptionStatus",render:({field:s})=>e.jsxs(i,{className:"col-span-4",children:[e.jsx(c,{children:"Subscription Status"}),e.jsxs(z,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(J,{children:e.jsx(R,{placeholder:"Select a subject"})})}),e.jsxs(W,{children:[e.jsx(j,{value:"paid",children:"Paid"}),e.jsx(j,{value:"waiting",children:"Waiting"}),e.jsx(j,{value:"expired",children:"Expired"})]})]}),e.jsx(d,{})]})})}),e.jsx(Y,{children:e.jsx(b,{type:"submit",children:"Update Student"})})]})})})]})};export{te as default};
